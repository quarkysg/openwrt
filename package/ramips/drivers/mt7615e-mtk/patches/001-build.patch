Index: mt7615e-mtk/mt_wifi/embedded/common/cmm_info.c
===================================================================
--- a/mt_wifi/embedded/common/cmm_info.c
+++ b/mt_wifi/embedded/common/cmm_info.c
@@ -10690,6 +10690,7 @@
 	RTMP_CHIP_CAP *pChipCap = hc_get_chip_cap(pAd->hdev_ctrl);
 
 	if (pAd->CommonCfg.dbdc_mode) { /* Dual Band */
+#ifdef WIFI_SPECTRUM_SUPPORT
 		if ((CapNode == pChipCap->SpectrumWF0ADC)  || (CapNode == pChipCap->SpectrumWF1ADC)
 			|| (CapNode == pChipCap->SpectrumWF0FIIQ) || (CapNode == pChipCap->SpectrumWF1FIIQ)
 			|| (CapNode == pChipCap->SpectrumWF0FDIQ) || (CapNode == pChipCap->SpectrumWF1FDIQ))
@@ -10698,6 +10699,7 @@
 				 || (CapNode == pChipCap->SpectrumWF2FIIQ) || (CapNode == pChipCap->SpectrumWF3FIIQ)
 				 || (CapNode == pChipCap->SpectrumWF2FDIQ) || (CapNode == pChipCap->SpectrumWF3FDIQ))
 			rfic =  RFIC_5GHZ;
+#endif
 	} else { /* Single Band */
 		if (HcGetRadioChannel(pAd) <= 14)
 			rfic = RFIC_24GHZ;
@@ -10748,6 +10750,7 @@
 	RTMP_CHIP_CAP *pChipCap = hc_get_chip_cap(pAd->hdev_ctrl);
 
 	if (pAd->CommonCfg.dbdc_mode) { /* Dual Band */
+#ifdef WIFI_SPECTRUM_SUPPORT
 		if ((CapNode == pChipCap->SpectrumWF0ADC)  || (CapNode == pChipCap->SpectrumWF1ADC)
 			|| (CapNode == pChipCap->SpectrumWF0FIIQ) || (CapNode == pChipCap->SpectrumWF1FIIQ)
 			|| (CapNode == pChipCap->SpectrumWF0FDIQ) || (CapNode == pChipCap->SpectrumWF1FDIQ))
@@ -10756,6 +10759,7 @@
 				 || (CapNode == pChipCap->SpectrumWF2FIIQ) || (CapNode == pChipCap->SpectrumWF3FIIQ)
 				 || (CapNode == pChipCap->SpectrumWF2FDIQ) || (CapNode == pChipCap->SpectrumWF3FDIQ))
 			rfic = RFIC_5GHZ;
+#endif
 	} else { /* Single Band */
 		if (HcGetRadioChannel(pAd) <= 14)
 			rfic = RFIC_24GHZ;

Index: mt7615e-mtk/mt_wifi/os/linux/rt_proc.c
===================================================================
--- a/mt_wifi/os/linux/rt_proc.c
+++ b/mt_wifi/os/linux/rt_proc.c
@@ -29,7 +29,7 @@
 #include <linux/kernel.h>
 #include <linux/types.h>
 #include <linux/proc_fs.h>
-#include <asm/uaccess.h>
+#include <linux/uaccess.h>
 
 #include "rt_config.h"
 
Index: mt7615e-mtk/mt_wifi/os/linux/rt_linux.c
===================================================================
--- a/mt_wifi/os/linux/rt_linux.c
+++ b/mt_wifi/os/linux/rt_linux.c
@@ -803,7 +803,7 @@
 #else
 
 	if (osfd->f_mode & FMODE_CAN_READ) {
-		return __vfs_read(osfd, pDataPtr, readLen, &osfd->f_pos);
+		return kernel_read(osfd, pDataPtr, readLen, &osfd->f_pos);
 #endif
 	} else {
 		MTWF_LOG(DBG_CAT_INIT, DBG_SUBCAT_ALL, DBG_LVL_ERROR, ("no file read method\n"));
@@ -817,7 +817,7 @@
 #if (KERNEL_VERSION(4, 1, 0) > LINUX_VERSION_CODE)
 	return osfd->f_op->write(osfd, pDataPtr, (size_t) writeLen, &osfd->f_pos);
 #else
-	return __vfs_write(osfd, pDataPtr, (size_t) writeLen, &osfd->f_pos);
+	return kernel_write(osfd, pDataPtr, (size_t) writeLen, &osfd->f_pos);
 #endif
 }
 
@@ -1917,7 +1917,7 @@
 				MTWF_LOG(DBG_CAT_INIT, DBG_SUBCAT_ALL, DBG_LVL_ERROR, ("no file write method\n"));
 			}
 #else
-			__vfs_write(file_w, msg, strlen(msg), &file_w->f_pos);
+			kernel_write(file_w, msg, strlen(msg), &file_w->f_pos);
 #endif
 				MTWF_LOG(DBG_CAT_INIT, DBG_SUBCAT_ALL, DBG_LVL_ERROR, ("%s", msg));
 				macAddr += AddrStep;
@@ -1977,7 +1977,7 @@
 					MTWF_LOG(DBG_CAT_INIT, DBG_SUBCAT_ALL, DBG_LVL_ERROR, ("no file write method\n"));
 				}
 #else
-				__vfs_write(file_w, msg, strlen(msg), &file_w->f_pos);
+				kernel_write(file_w, msg, strlen(msg), &file_w->f_pos);
 #endif
 				MTWF_LOG(DBG_CAT_INIT, DBG_SUBCAT_ALL, DBG_LVL_ERROR, ("%s", msg));
 				eepAddr += AddrStep;
@@ -2025,7 +2025,7 @@
 				MTWF_LOG(DBG_CAT_INIT, DBG_SUBCAT_ALL, DBG_LVL_ERROR, ("no file write method\n"));
 			}
 #else
-			__vfs_write(file_w, pBuf, BufLen, &file_w->f_pos);
+			kernel_write(file_w, pBuf, BufLen, &file_w->f_pos);
 #endif
 		}
 


Index: mt7615e-mtk/mt_wifi/os/linux/Makefile.mt_wifi_ap
===================================================================
--- a/mt_wifi/os/linux/Makefile.mt_wifi_ap
+++ b/mt_wifi/os/linux/Makefile.mt_wifi_ap
@@ -13,7 +13,7 @@
 				-I$(WIFI_DRV_PATH)/mt_wifi/ate/include \
 				-I$(WIFI_DRV_PATH)/mt_wifi/include/mcu
 
-DRV_NAME = mt_wifi
+DRV_NAME = mt7615e-mtk
 SRC_DIR = ../mt_wifi
 SRC_EMBEDDED_DIR = ../mt_wifi/embedded
 ifeq ($(CONFIG_SUPPORT_OPENWRT),y)

Index: mt7615e-mtk/mt_wifi/embedded/common/ee_flash.c
===================================================================
--- a/mt_wifi/embedded/common/ee_flash.c
+++ b/mt_wifi/embedded/common/ee_flash.c
@@ -137,7 +138,18 @@
 	ULONG a,
 	ULONG b)
 {
-	flash_read(hdev_ctrl, p, a, b);
+	struct _RTMP_ADAPTER *ad = ((struct hdev_ctrl *) hdev_ctrl)->priv;
+	UCHAR *buffer = NULL;
+	UINT32 len;
+	UCHAR *name = "mt7615_eeprom.bin";
+
+	/*load from request firmware*/
+	os_load_code_from_bin(ad, &buffer, name, &len);
+
+	if (len > 0 && buffer != NULL) {
+		os_move_mem(p, buffer + a, b);
+		os_free_mem(buffer);
+	}
 }
 
 void RtmpFlashWrite(
@@ -146,7 +155,6 @@
 	ULONG a,
 	ULONG b)
 {
-	flash_write(hdev_ctrl, p, a, b);
 }
 
 

Index: mt7615e-mtk/mt_wifi/chips/mt7615.c
===================================================================
--- a/mt_wifi/chips/mt7615.c
+++ b/mt_wifi/chips/mt7615.c
@@ -2132,20 +2132,20 @@ UCHAR *mt7615_get_default_bin_image_file
 			("Use %dst %s default bin.\n", multi_inf_get_idx(pAd), DEFAULT_BIN_FILE));
 		return DEFAULT_BIN_FILE;
 	}
-#if defined(MT_SECOND_CARD)
+#if defined(CONFIG_RT_SECOND_CARD)
 	else if (multi_inf_get_idx(pAd) == 1) {
 		MTWF_LOG(DBG_CAT_HW, DBG_SUBCAT_ALL, DBG_LVL_OFF,
 			("Use %dst %s default bin.\n", multi_inf_get_idx(pAd), SECOND_BIN_FILE));
 		return SECOND_BIN_FILE;
 	}
-#endif /* MT_SECOND_CARD */
-#if defined(MT_THIRD_CARD)
+#endif /* CONFIG_RT_SECOND_CARD */
+#if defined(CONFIG_RT_THIRD_CARD)
 	else if (multi_inf_get_idx(pAd) == 2) {
 		MTWF_LOG(DBG_CAT_HW, DBG_SUBCAT_ALL, DBG_LVL_OFF,
 			("Use %dst %s default bin.\n", multi_inf_get_idx(pAd), THIRD_BIN_FILE));
 		return THIRD_BIN_FILE;
 	}
-#endif /* MT_THIRD_CARD */
+#endif /* CONFIG_RT_THIRD_CARD */
 	else
 #endif /* MULTI_INF_SUPPORT */
 	{

Index: mt7615e-mtk/mt_wifi/os/linux/rt_profile.c
===================================================================
--- a/mt_wifi/os/linux/rt_profile.c
+++ b/mt_wifi/os/linux/rt_profile.c
@@ -98,13 +98,13 @@
 #define xdef_to_str(s)   def_to_str(s)
 #define def_to_str(s)    #s
 
-#define FIRST_EEPROM_FILE_PATH	"/etc_ro/Wireless/RT2860/"
-#define FIRST_AP_PROFILE_PATH		"/etc/Wireless/RT2860/RT2860.dat"
+#define FIRST_EEPROM_FILE_PATH	"/lib/firmware/"
+#define FIRST_AP_PROFILE_PATH		"/etc/wireless/mt7615e/mt7615e.1.dat"
 #define FIRST_STA_PROFILE_PATH      "/etc/Wireless/RT2860/RT2860.dat"
 #define FIRST_CHIP_ID	xdef_to_str(CONFIG_RT_FIRST_CARD)
 
-#define SECOND_EEPROM_FILE_PATH	"/etc_ro/Wireless/iNIC/"
-#define SECOND_AP_PROFILE_PATH	"/etc/Wireless/iNIC/iNIC_ap.dat"
+#define SECOND_EEPROM_FILE_PATH	"/lib/firmware/"
+#define SECOND_AP_PROFILE_PATH	"/etc/wireless/mt7615e/mt7615e.2.dat"
 #define SECOND_STA_PROFILE_PATH "/etc/Wireless/iNIC/iNIC_sta.dat"
 
 #define SECOND_CHIP_ID	xdef_to_str(CONFIG_RT_SECOND_CARD)

Index: mt7615e-mtk/mt_wifi/include/os/rt_linux.h
===================================================================
--- a/mt_wifi/include/os/rt_linux.h
+++ b/mt_wifi/include/os/rt_linux.h
@@ -135,7 +135,7 @@
 #ifdef CONFIG_AP_SUPPORT
 #ifdef RTMP_MAC_PCI
 #if CONFIG_RTPCI_AP_RF_OFFSET == 0x48000
-#define AP_PROFILE_PATH			"/etc/Wireless/iNIC/iNIC_ap.dat"
+#define AP_PROFILE_PATH                        "/etc/wireless/mt7615e/mt7615e.2.dat"
 #define AP_RTMP_FIRMWARE_FILE_NAME "/etc_ro/Wireless/iNIC/RT2860AP.bin"
 #else
 #define AP_PROFILE_PATH			"/etc/Wireless/RT2860AP/RT2860AP.dat"
@@ -155,13 +155,13 @@
 /* This used for rbus-based chip, maybe we can integrate it together. */
 #define RTMP_FIRMWARE_FILE_NAME		"/etc_ro/Wireless/RT2860AP/RT2860AP.bin"
 #define PROFILE_PATH			"/etc/Wireless/RT2860i.dat"
-#define AP_PROFILE_PATH_RBUS		"/etc/Wireless/RT2860/RT2860.dat"
+#define AP_PROFILE_PATH_RBUS		"/etc/wireless/mt7615e/mt7615e.1.dat"
 #define RT2880_AP_DRIVER_VERSION	"1.0.0.0"
 #endif /* RTMP_RBUS_SUPPORT */
 
 #ifdef SINGLE_SKU_V2
-#define SINGLE_SKU_TABLE_FILE_NAME	"/etc_ro/Wireless/RT2860AP/SingleSKU.dat"
-#define BF_SKU_TABLE_FILE_NAME      "/etc_ro/Wireless/RT2860AP/SingleSKU_BF.dat"
+#define SINGLE_SKU_TABLE_FILE_NAME	"/etc/wireless/mt7615e/SingleSKU.dat"
+#define BF_SKU_TABLE_FILE_NAME      "/etc/wireless/mt7615e/SingleSKU_BF.dat"
 #endif /* SINGLE_SKU_V2 */
 
 #endif /* CONFIG_AP_SUPPORT */

Index: mt7615e-mtk/mt_wifi/embedded/include/l1profile.h
===================================================================
--- a/mt_wifi/embedded/include/l1profile.h
+++ b/mt_wifi/embedded/include/l1profile.h
@@ -1,7 +1,7 @@
 UCHAR l1profile_default[] = {
 "Default\n\
 INDEX0=MT7615\n\
-INDEX0_profile_path=/etc/Wireless/RT2860/RT2860.dat\n\
+INDEX0_profile_path=/etc/wireless/mt7615e/mt7615e.1.dat\n\
 INDEX0_EEPROM_offset=0x0\n\
 INDEX0_EEPROM_size=0x4000\n\
 INDEX0_EEPROM_name=e2p\n\
@@ -11,10 +11,10 @@
 INDEX0_apcli_ifname=apcli\n\
 INDEX0_mesh_ifname=mesh\n\
 INDEX0_nvram_zone=RT2860\n\
-INDEX0_single_sku_path=/etc_ro/Wireless/RT2860AP/SingleSKU.dat\n\
-INDEX0_bf_sku_path=/etc_ro/Wireless/RT2860AP/SingleSKU_BF.dat\n\
+INDEX0_single_sku_path=/etc/wireless/mt7615e/SingleSKU.dat\n\
+INDEX0_bf_sku_path=/etc/wireless/mt7615e/SingleSKU_BF.dat\n\
 INDEX1=MT7615\n\
-INDEX1_profile_path=/etc/Wireless/iNIC/iNIC_ap.dat\n\
+INDEX1_profile_path=/etc/wireless/mt7615e/mt7615e.2.dat\n\
 INDEX1_EEPROM_offset=0x8000\n\
 INDEX1_EEPROM_size=0x4000\n\
 INDEX1_EEPROM_name=e2p\n\
@@ -24,8 +24,8 @@
 INDEX1_apcli_ifname=apclii\n\
 INDEX1_mesh_ifname=meshi\n\
 INDEX1_nvram_zone=RTDEV\n\
-INDEX1_single_sku_path=/etc_ro/Wireless/RT2860AP/SingleSKU.dat\n\
-INDEX1_bf_sku_path=/etc_ro/Wireless/RT2860AP/SingleSKU_BF.dat\n\
+INDEX1_single_sku_path=/etc/wireless/mt7615e/SingleSKU.dat\n\
+INDEX1_bf_sku_path=/etc/wireless/mt7615e/SingleSKU_BF.dat\n\
 INDEX2=MT7615\n\
 INDEX2_profile_path=/etc/Wireless/WIFI3/RT2870AP.dat\n\
 INDEX2_EEPROM_offset=0x4000\n\
